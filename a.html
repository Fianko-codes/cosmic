<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Enhanced Cosmic Portfolio - Fianko-codes</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      background: black;
      font-family: 'Arial', sans-serif;
    }
    
    #infoBox {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.85);
      padding: 20px;
      border-radius: 12px;
      color: white;
      max-width: 300px;
      display: none;
      z-index: 10;
      border: 1px solid rgba(0, 255, 255, 0.3);
      backdrop-filter: blur(10px);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
    }

    #infoBox h2 {
      margin-top: 0;
      color: #0ff;
      border-bottom: 1px solid rgba(0, 255, 255, 0.3);
      padding-bottom: 10px;
    }

    #planetInfo {
      line-height: 1.6;
    }

    #closeBtn {
      margin-top: 15px;
      padding: 8px 16px;
      background: linear-gradient(45deg, #0ff, #00a0a0);
      border: none;
      cursor: pointer;
      border-radius: 6px;
      color: black;
      font-weight: bold;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    #closeBtn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
    }

    #stats {
      position: absolute;
      top: 20px;
      right: 20px;
      color: #0ff;
      background: rgba(0, 0, 0, 0.85);
      padding: 15px;
      border-radius: 8px;
      font-size: 14px;
      border: 1px solid rgba(0, 255, 255, 0.3);
      backdrop-filter: blur(10px);
    }

    #controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.85);
      padding: 15px;
      border-radius: 8px;
      display: flex;
      gap: 10px;
      border: 1px solid rgba(0, 255, 255, 0.3);
      backdrop-filter: blur(10px);
    }

    .control-btn {
      padding: 8px 16px;
      background: linear-gradient(45deg, #0ff, #00a0a0);
      border: none;
      cursor: pointer;
      border-radius: 6px;
      color: black;
      font-weight: bold;
      transition: transform 0.2s;
    }

    .control-btn:hover {
      transform: scale(1.05);
    }

    #loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: black;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #0ff;
      font-size: 24px;
      z-index: 1000;
    }

    .progress {
      width: 200px;
      height: 4px;
      background: rgba(0, 255, 255, 0.2);
      border-radius: 2px;
      margin-top: 10px;
    }

    .progress-bar {
      height: 100%;
      background: #0ff;
      width: 0%;
      border-radius: 2px;
      transition: width 0.3s;
    }

    canvas { 
      display: block; 
    }
  </style>
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>
</head>
<body>
  <div id="loading">
    Loading Solar System...
    <div class="progress">
      <div class="progress-bar"></div>
    </div>
  </div>

  <div id="infoBox">
    <h2 id="planetName"></h2>
    <p id="planetInfo"></p>
    <button id="closeBtn">Close</button>
  </div>

  <div id="stats">
    FPS: <span id="fps">0</span><br>
    Distance from Sun: <span id="distance">0</span> AU
  </div>

  <div id="controls">
    <button class="control-btn" id="toggleOrbits">Toggle Orbits</button>
    <button class="control-btn" id="toggleAutoRotate">Auto Rotate</button>
    <button class="control-btn" id="resetCamera">Reset View</button>
  </div>

  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    import { RGBELoader } from 'three/addons/loaders/RGBELoader.js';

    let scene, camera, renderer, controls;
    const textureLoader = new THREE.TextureLoader();
    const loadingManager = new THREE.LoadingManager();
    const progressBar = document.querySelector('.progress-bar');
    const loadingScreen = document.getElementById('loading');

    // Loading manager setup
    loadingManager.onProgress = (url, loaded, total) => {
      progressBar.style.width = (loaded / total * 100) + '%';
    };

    loadingManager.onLoad = () => {
      setTimeout(() => {
        loadingScreen.style.display = 'none';
      }, 500);
    };

    // Scene setup
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
    camera.position.set(0, 100, 200);

    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 0.5;
    document.body.appendChild(renderer.domElement);

    controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
    controls.minDistance = 20;
    controls.maxDistance = 500;

    // Lighting
    scene.add(new THREE.AmbientLight(0xffffff, 0.2));
    const sunLight = new THREE.PointLight(0xffffaa, 2);
    sunLight.castShadow = true;
    scene.add(sunLight);

    // HDR Background
    new RGBELoader(loadingManager)
      .load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/equirectangular/starmap_4k.hdr', function(texture) {
        texture.mapping = THREE.EquirectangularReflectionMapping;
        scene.background = texture;
      });

    // Stars
    const starCount = 20000;
    const starGeometry = new THREE.BufferGeometry();
    const starPositions = new Float32Array(starCount * 3);
    const starColors = new Float32Array(starCount * 3);

    for (let i = 0; i < starCount * 3; i += 3) {
      const radius = Math.random() * 1000 + 500;
      const theta = Math.random() * Math.PI * 2;
      const phi = Math.acos(Math.random() * 2 - 1);
      
      starPositions[i] = radius * Math.sin(phi) * Math.cos(theta);
      starPositions[i + 1] = radius * Math.sin(phi) * Math.sin(theta);
      starPositions[i + 2] = radius * Math.cos(phi);

      const color = new THREE.Color();
      color.setHSL(Math.random(), 0.5, 0.8);
      starColors[i] = color.r;
      starColors[i + 1] = color.g;
      starColors[i + 2] = color.b;
    }

    starGeometry.setAttribute('position', new THREE.BufferAttribute(starPositions, 3));
    starGeometry.setAttribute('color', new THREE.BufferAttribute(starColors, 3));

    const starMaterial = new THREE.PointsMaterial({
      size: 2,
      vertexColors: true,
      transparent: true,
      opacity: 0.8
    });

    const starField = new THREE.Points(starGeometry, starMaterial);
    scene.add(starField);

    // Sun
    const sunTexture = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/sun.jpg', undefined, undefined, function(err) {
      console.error('Error loading sun texture:', err);
    });
    
    const sun = new THREE.Mesh(
      new THREE.SphereGeometry(10, 64, 64),
      new THREE.MeshBasicMaterial({ 
        map: sunTexture,
        emissive: 0xffff00,
        emissiveIntensity: 0.5
      })
    );
    scene.add(sun);

    // Sun glow
    const sunGlow = new THREE.Sprite(
      new THREE.SpriteMaterial({
        map: textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/glow.png'),
        color: 0xffff00,
        transparent: true,
        blending: THREE.AdditiveBlending
      })
    );
    sunGlow.scale.set(40, 40, 1);
    sun.add(sunGlow);

    // Planet data with enhanced information
    const planets = [
      {
        name: 'Mercury',
        size: 1,
        dist: 20,
        color: 0xaaaaaa,
        info: 'Mercury is the smallest and innermost planet in the Solar System. It completes an orbit around the Sun every 88 Earth days, the shortest of all the Sun\'s planets.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/mercury.jpg'
      },
      {
        name: 'Venus',
        size: 1.5,
        dist: 30,
        color: 0xffddaa,
        info: 'Venus is the second planet from the Sun and the hottest planet in our solar system with a surface temperature of 462°C (864°F).',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/venus.jpg'
      },
      {
        name: 'Earth',
        size: 2,
        dist: 40,
        color: 0x3399ff,
        info: 'Earth is the third planet from the Sun and the only astronomical object known to harbor life. About 29.2% of Earth\'s surface is land and 70.8% is water.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth.jpg',
        bumpUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_normal.jpg',
        specularUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_specular.jpg'
      },
      {
        name: 'Mars',
        size: 1.8,
        dist: 50,
        color: 0xff4422,
        info: 'Mars is often called the "Red Planet" due to its reddish appearance. It has the largest volcano in the Solar System, Olympus Mons.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/mars.jpg'
      },
      {
        name: 'Jupiter',
        size: 5,
        dist: 70,
        color: 0xffbb88,
        info: 'Jupiter is the largest planet in our solar system. Its Great Red Spot is a giant storm that has been raging for at least 400 years.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/jupiter.jpg'
      },
      {
        name: 'Saturn',
        size: 4.5,
        dist: 90,
        color: 0xffeeaa,
        info: 'Saturn is famous for its spectacular ring system, which is composed mostly of ice particles, rocky debris, and dust.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/saturn.jpg',
        hasRings: true
      },
      {
        name: 'Uranus',
        size: 3,
        dist: 110,
        color: 0xaaffff,
        info: 'Uranus is the only planet that rotates on its side. Its unique tilt causes extreme seasons that last for decades.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/uranus.jpg'
      },
      {
        name: 'Neptune',
        size: 3,
        dist: 130,
        color: 0x5555ff,
        info: 'Neptune is the windiest planet, with speeds reaching 2,100 km/h. It has a Great Dark Spot similar to Jupiter\'s Great Red Spot.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/neptune.jpg'
      },
      {
        name: 'Pluto',
        size: 0.8,
        dist: 150,
        color: 0xffffff,
        info: 'Although no longer classified as a planet, Pluto remains one of the most fascinating objects in our solar system with its heart-shaped region called Tombaugh Regio.',
        textureUrl: 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/pluto.jpg'
      }
    ];

    const planetObjs = [];
    const orbitLines = [];

    // Create orbit lines
    planets.forEach(p => {
      const orbitGeometry = new THREE.RingGeometry(p.dist, p.dist + 0.1, 128);
      const orbitMaterial = new THREE.MeshBasicMaterial({
        color: 0x444444,
        side: THREE.DoubleSide,
        transparent: true,
        opacity: 0.3
      });
      const orbitLine = new THREE.Mesh(orbitGeometry, orbitMaterial);
      orbitLine.rotation.x = Math.PI / 2;
      scene.add(orbitLine);
      orbitLines.push(orbitLine);
    });

    // Create planets
    planets.forEach(p => {
      const texture = textureLoader.load(p.textureUrl);
      const material = new THREE.MeshStandardMaterial({
        map: texture,
        metalness: 0,
        roughness: 0.8
      });

      if (p.name === 'Earth') {
        material.normalMap = textureLoader.load(p.bumpUrl);
        material.specularMap = textureLoader.load(p.specularUrl);
      }

      const mesh = new THREE.Mesh(
        new THREE.SphereGeometry(p.size, 32, 32),
        material
      );

      if (p.hasRings) {
        const ringGeometry = new THREE.RingGeometry(p.size * 1.4, p.size * 2, 64);
        const ringMaterial = new THREE.MeshBasicMaterial({
          map: textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/saturn_rings.jpg'),
          side: THREE.DoubleSide,
          transparent: true,
          opacity: 0.8
        });
        const rings = new THREE.Mesh(ringGeometry, ringMaterial);
        rings.rotation.x = Math.PI / 2;
        mesh.add(rings);
      }

      const orbit = new THREE.Object3D();
      mesh.position.x = p.dist;
      orbit.add(mesh);
      scene.add(orbit);

      planetObjs.push({
        orbit,
        dist: p.dist,
        speed: 0.001 * (1 / Math.sqrt(p.dist)), // Kepler's Third Law approximation
        name: p.name,
        info: p.info,
        mesh
      });
    });

    // Audio
    const clickSound = new Audio('https://www.soundjay.com/button/sounds/button-16.mp3');

    // UI Elements
    const infoBox = document.getElementById('infoBox');
    const planetName = document.getElementById('planetName');
    const planetInfo = document.getElementById('planetInfo');
    const closeBtn = document.getElementById('closeBtn');
    const fpsCounter = document.getElementById('fps');
    const distanceDisplay = document.getElementById('distance');
    const toggleOrbitsBtn = document.getElementById('toggleOrbits');
    const toggleAutoRotateBtn = document.getElementById('toggleAutoRotate');
    const resetCameraBtn = document.getElementById('resetCamera');

    // Event Listeners
    closeBtn.addEventListener('click', () => {
      infoBox.style.display = 'none';
    });

    toggleOrbitsBtn.addEventListener('click', () => {
      orbitLines.forEach(line => line.visible = !line.visible);
    });

    toggleAutoRotateBtn.addEventListener('click', () => {
      controls.autoRotate = !controls.autoRotate;
      toggleAutoRotateBtn.textContent = controls.autoRotate ? 'Stop Rotation' : 'Auto Rotate';
    });

    resetCameraBtn.addEventListener('click', () => {
      camera.position.set(0, 100, 200);
      camera.lookAt(0, 0, 0);
      controls.reset();
    });

    // Click interaction
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();

    window.addEventListener('click', (event) => {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
      raycaster.setFromCamera(mouse, camera);
      
      const intersects = raycaster.intersectObjects(planetObjs.map(p => p.mesh));
      if (intersects.length > 0) {
        const planet = planetObjs.find(p => p.mesh === intersects[0].object);
        clickSound.currentTime = 0;
        clickSound.play();
        
        planetName.textContent = planet.name;
        planetInfo.textContent = planet.info;
        infoBox.style.display = 'block';
        
        // Calculate distance from Sun in AU
        const distance = (planet.dist / 40).toFixed(2); // Using Earth's distance as 1 AU
        distanceDisplay.textContent = distance;
      }
    });

    // FPS Counter
    let frameCount = 0;
    let lastTime = performance.now();

    function updateFPS() {
      const now = performance.now();
      frameCount++;
      
      if (now > lastTime + 1000) {
        fpsCounter.textContent = frameCount;
        frameCount = 0;
        lastTime = now;
      }
    }

    // Animation
    function animate() {
      requestAnimationFrame(animate);
      updateFPS();

      planetObjs.forEach(p => {
        p.orbit.rotation.y += p.speed;
        p.mesh.rotation.y += p.speed * 2;
      });

      starField.rotation.y += 0.0001;
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // Resize handling
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Mobile touch support
    let touchStartX;
    let touchStartY;

    renderer.domElement.addEventListener('touchstart', (event) => {
      touchStartX = event.touches[0].clientX;
      touchStartY = event.touches[0].clientY;
    });

    renderer.domElement.addEventListener('touchend', (event) => {
      const touchEndX = event.changedTouches[0].clientX;
      const touchEndY = event.changedTouches[0].clientY;
      
      // Only trigger click if it's a tap (small movement)
      if (Math.abs(touchEndX - touchStartX) < 10 && Math.abs(touchEndY - touchStartY) < 10) {
        mouse.x = (touchEndX / window.innerWidth) * 2 - 1;
        mouse.y = -(touchEndY / window.innerHeight) * 2 + 1;
        raycaster.setFromCamera(mouse, camera);
        
        const intersects = raycaster.intersectObjects(planetObjs.map(p => p.mesh));
        if (intersects.length > 0) {
          const planet = planetObjs.find(p => p.mesh === intersects[0].object);
          clickSound.currentTime = 0;
          clickSound.play();
          
          planetName.textContent = planet.name;
          planetInfo.textContent = planet.info;
          infoBox.style.display = 'block';
        }
      }
    });
  </script>
</body>
</html>